This is my second filein the code branch. Modifications are neccasary for this code.
There is some bugs. Resolve and tag them.
